
const glbs = [
    {
      "modelName": "torre1",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre1.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Torre1low.webp"
      }
    },
    {
      "modelName": "torre1_ventanas",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre1Ventanas.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Torre1Ventanaslow.webp"
      }
    },
    {
        "modelName": "torre1_fachada_falsa",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre1FachadaFalsa.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre1FachadaFalsalow.webp"
        }
    },
    {
        "modelName": "torre1_cubierta",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre1Cubierta.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre1Cubiertalow.webp"
        }
    },
    {
        "modelName": "torre1_escaleras",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre2Escaleras.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre1Escaleraslow.webp"
        }
    },
    {
        "modelName": "torre2",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre2.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre2.webp"
        }
    },
    {
        "modelName": "torre2_ventanas",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre2Ventanas.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre2Ventanas.webp"
        }
    },
    {
        "modelName": "torre2_fachada_falsa",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre2FachadaFalsa.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre2FachadaFalsa.webp"
        }
    },
    {
        "modelName": "torre2_cubierta",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre2Cubierta.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre2Cubierta.webp"
        }
    },
    {
        "modelName": "torre2_escaleras",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre2Escaleras.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre2Escaleras.webp"
        }
    },
    {
          "modelName": "torre3",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre3.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre3.webp"
        }
    },
    {
          "modelName": "torre3_cubierta",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre3Cubierta.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre3Cubierta.webp"
        }
    },
    {
          "modelName": "torre4",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre4.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre4.webp"
        }
    },
    {
          "modelName": "torre4_cubierta",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre4Cubierta.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre4Cubierta.webp"
        }
    },
    {
          "modelName": "torre3y4_ventanas",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre3y4Ventanas.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre3y4Ventanas.webp"
        }
    },
    {
          "modelName": "torre3y4_Fachada_Falsa",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre3y4FachadaFalsa.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre3y4FachadaFalsa.webp"
        }
    },
    {
          "modelName": "torre3y4_Deck",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Torre3y4Deck.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Torre3y4Deck.webp"
        }
    },
    {
          "modelName": "salon_ascensor",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Ascensor.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Ascensor.webp"
        }
    },
    {
          "modelName": "salon_baranda_escalera",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/BarandaEscalera.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/BarandaEscalera.webp"
        }
    },
    {
          "modelName": "salon_bordillo",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Bordillo.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Bordillo.webp"
        }
    },
    {
          "modelName": "salon_chimenea",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Chimenea.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Chimenea.webp"
        }
    },
    {
          "modelName": "salon_comunal",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Comunal.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Comunal.webp"
        }
    },
    {
          "modelName": "salon_escaleras",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Escaleras.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Escaleras.webp"
        }
    },
    {
          "modelName": "salon_fachada",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/FachadaFalsa.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/FachadaFalsa.webp"
        }
    },
    {
          "modelName": "salon_laminado1",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Laminado1.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Laminado1.webp"
        }
    },
    {
          "modelName": "salon_laminado2",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Laminado2.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Laminado2.webp"
        }
    },
    {
          "modelName": "salon_logotipo",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Logotipo.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Logotipo.webp"
        }
    },
    {
          "modelName": "salon_pasto",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Pasto.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Pasto.webp"
        }
    },
    {
          "modelName": "salon_salida",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/SalidaEmergencia.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/SalidaEmergencia.webp"
        }
    },
    {
          "modelName": "salon_ventanas",
        "glbfile": "https://babylongrendering.blob.core.windows.net/models/Ventanas.glb",
        "texture": {
          "url": "https://babylongrendering.blob.core.windows.net/textures/Ventanas.webp"
        }
    },
    {
      "modelName": "urbanismo_adoquin",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Adoquin.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Adoquin.webp"
      }
    },
    {
      "modelName": "urbanismo_adoquin_ocre",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/AdoquinOcre.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/AdoquinOcre.webp"
      }
    },
    {
      "modelName": "urbanismo_caminos_robles",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/CaminosRobles.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CaminosRobles.webp"
      }
    },
    {
      "modelName": "urbanismo_andenes",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Andenes.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Andenes.webp"
      }
    },
    {
      "modelName": "urbanismo_andenes",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Andenes.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Andenes.webp"
      }
    },
    {
      "modelName": "urbanismo_arcos_futbol",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/ArcosFutbol.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/ArcosFutbol.webp"
      }
    },
    {
      "modelName": "urbanismo_cancha",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Cancha.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Cancha.webp"
      }
    },
    {
      "modelName": "urbanismo_cancha_alpha",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Cancha.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CanchaAlpha.webp"
      }
    },
    {
      "modelName": "urbanismo_cancha_voley",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/CanchaVolley.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CanchaVolley.webp"
      }
    },
    {
      "modelName": "urbanismo_carretera",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Carretera.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Carretera.webp"
      }
    },
    {
      "modelName": "urbanismo_casas_vecinas",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/CasasVecinas.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CasasVecinas.webp"
      }
    },
    {
      "modelName": "urbanismo_casas_vecinas",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/CasasVecinas.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CasasVecinas.webp"
      }
    },
    {
      "modelName": "urbanismo_cerramiento_parques",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/CerramientoParques.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CerramientoParques.webp"
      }
    },
    {
      "modelName": "urbanismo_ciclovia",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Ciclovia.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Ciclovia.webp"
      }
    },
    {
      "modelName": "urbanismo_circuito_trote",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/CircuitoTrote.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CircuitoTrote.webp"
      }
    },
    {
      "modelName": "urbanismo_concreto",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Concreto.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Concreto.webp"
      }
    },
    {
      "modelName": "urbanismo_deck_concreto",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/DeckConcreto.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/DeckConcreto.webp"
      }
    },
    {
      "modelName": "urbanismo_malla_volley",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/MallaVoley.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/MallaVoley.webp"
      }
    },
    {
      "modelName": "urbanismo_parque_futbol",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/ParqueFutbol.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/ParqueFutbol.webp"
      }
    },
    {
      "modelName": "urbanismo_pasto",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Pasto.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Pasto4.webp"
      }
    },
    {
      "modelName": "urbanismo_pasto_sendero",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/PastoSendero.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/PastoSendero.webp"
      }
    },
    {
      "modelName": "urbanismo_rampas",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Rampas.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Rampas.webp"
      }
    },
    {
      "modelName": "urbanismo_sinteticos",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Sinteticos.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/Sinteticos.webp"
      }
    },
    {
      "modelName": "flora_adoquin",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraAdoquin.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraAdoquin.webp"
      }
    },
    {
      "modelName": "flora_anden",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraAnden.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraAnden.webp"
      }
    },
    {
      "modelName": "flora_bancas",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraBancas.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraBancas.webp"
      }
    },
    {
      "modelName": "flora_baranda_escaleras",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraBarandaEscaleras.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraBarandaEscaleras.webp"
      }
    },
    {
      "modelName": "flora_bordillo",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraBordillo.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraBordillo.webp"
      }
    },
    {
      "modelName": "flora_cerramiento",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraCerramiento.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraCerramiento.webp"
      }
    },
    {
      "modelName": "flora_escaleras",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraEscaleras.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraEscaleras.webp"
      }
    },
    {
      "modelName": "flora_lobby",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraLobby.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraLobby.webp"
      }
    },
    {
      "modelName": "flora_ventana",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraVentana.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloralVentana.webp"
      }
    },
    {
      "modelName": "flora_muros",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraMuros.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraMuros.webp"
      }
    },
    {
      "modelName": "flora_muros_parqueadero",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraMurosParqueadero.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraMurosParqueadero.webp"
      }
    },
    {
      "modelName": "flora_capuchino",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraParedCapuchino.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraParedCapuchino.webp"
      }
    },
    {
      "modelName": "flora_pisos",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraPisos.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraPisos.webp"
      }
    },
    {
      "modelName": "flora_sintetico_azul",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraSinteticoAzul.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraSinteticoAzul.webp"
      }
    },
    {
      "modelName": "flora_tierra",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraTierra.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraTierra3.webp"
      }
    },
    {
      "modelName": "flora_volumen",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/FloraVolumen.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/FloraVolumen.webp"
      }
    },
    {
      "modelName": "urbanismo_cancha_alpha",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Cancha.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/CanchaAlpha.webp"
      }
    },
    {
      "modelName": "urbanismo_malla_volley_alpha",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/MallaVoley.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/MallaVoleyAlpha.webp"
      }
    },
    {
      "modelName": "urbanismo_base_sintetico",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/BaseSintetico.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/BaseSintetico.webp"
      }
    },
    {
      "modelName": "urbanismo_arcos_futbol_alpha",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/ArcosFutbol.glb",
      "texture": {
        "url": "https://babylongrendering.blob.core.windows.net/textures/ArcosFutbolalpha.webp"
      }
    },
    {
      "modelName": "urbanismo_edificios",
      "glbfile": "https://babylongrendering.blob.core.windows.net/models/Edificios.glb",
      "texture": {
        "color": "#ffffff",
        "alpha": 0.7
      }
    }
  ];
// Obtener el lienzo de la página
var canvas = document.getElementById("renderCanvas");

// Crear una nueva escena en Babylon.js
var engine = new BABYLON.Engine(canvas, true);
var scene = new BABYLON.Scene(engine);
// scene.debugLayer.show();

loadModelsAndTextures();
// CameraDRONE();
CameraARC();

function loadModelsAndTextures() {
  const promises = []
  glbs.forEach(glb => {
    //Texture Type Validation
    if (glb.texture?.url) {
      promises.push(loadModel(glb.glbfile, { type: 'file', texture: glb.texture.url }, `${glb.modelName}`));
    }
    if (glb.texture?.color) {
      promises.push(loadModel(glb.glbfile, { type: 'color', texture: glb.texture }, `${glb.modelName}`));
    }
  });
  return Promise.all(promises);
}

function loadModel(modelFile, textureModel, materialName) {
  return new Promise((resolve) => {
    BABYLON.SceneLoader.ImportMesh("", "", modelFile, scene, function (meshes) {
      const meshMaterial = new BABYLON.StandardMaterial(materialName, scene);
      //Texture Type Validation
      if (textureModel.type === 'file') {
        const texture = new BABYLON.Texture(textureModel.texture, scene);
        texture.vScale = -1;
        // meshMaterial.diffuseTexture = texture;
      } else if (textureModel.type === 'color') {
        meshMaterial.diffuseColor = new BABYLON.Color3.FromHexString(textureModel.texture.color);
        meshMaterial.alpha = textureModel.texture.alpha;
      }
      meshes.forEach(mesh => {
        meshes[0].material = meshMaterial;
        meshes[1].material = meshMaterial;
        mesh.checkCollisions = true;
      })
      resolve();
    });
  });
}

//SKY
const skybox = BABYLON.MeshBuilder.CreateBox("skyBox", { size: 1000.0 }, scene);
const skyboxMaterial = new BABYLON.StandardMaterial("skyBox", scene);
skyboxMaterial.backFaceCulling = false;
skyboxMaterial.reflectionTexture = new BABYLON.CubeTexture("assets/textures/skybox", scene);
skybox.infiniteDistance = true;
skyboxMaterial.reflectionTexture.coordinatesMode = BABYLON.Texture.SKYBOX_MODE;
skyboxMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0);
skyboxMaterial.specularColor = new BABYLON.Color3(0, 0, 0);
skybox.material = skyboxMaterial;



function CameraARC() {
  // Configurar la cámara y la luz
  var camera = new BABYLON.ArcRotateCamera("camera1", -200, -200, -80, new BABYLON.Vector3(0, 200, 0), scene);

  camera.setTarget(BABYLON.Vector3.Zero());
  camera.attachControl(canvas, true);
  camera.lowerRadiusLimit = 150;
  camera.upperRadiusLimit = 300;
  camera.wheelDeltaPercentage = 0.01;
  camera.applyGravity = true;
  scene.collisionsEnabled = true;
  camera.checkCollisions = true;
  //Lights
  new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1000, 300), scene).intensity = 0.9;
}

function CameraDRONE() {
  const camera = new BABYLON.FlyCamera("FlyCamera", new BABYLON.Vector3(40, 60, 150), scene);
  camera.setTarget(new BABYLON.Vector3(20, 20, 0));
  // Airplane like rotation, with faster roll correction and banked-turns.
  // Default is 100. A higher number means slower correction.
  camera.rollCorrect = 10;
  // Default is false.
  camera.bankedTurn = true;
  // Defaults to 90° in radians in how far banking will roll the camera.
  camera.bankedTurnLimit = Math.PI / 2;
  // How much of the Yawing (turning) will affect the Rolling (banked-turn.)
  // Less than 1 will reduce the Rolling, and more than 1 will increase it.
  camera.bankedTurnMultiplier = 1;
  scene.gravity = new BABYLON.Vector3(0, -0.15, 0);

  // This attaches the camera to the canvas
  camera.attachControl(canvas, true);
  scene.collisionsEnabled = true;
  camera.checkCollisions = true;
  //Lights
  new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
}

// Iniciar la renderización
engine.runRenderLoop(function () {
  scene.render();
});
